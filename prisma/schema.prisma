// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Order {
  id              Int         @id @default(autoincrement())
  stripeSessionId String      @unique
  email           String?
  amountTotal     Int         // cents
  currency        String
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  items           OrderItem[]
}

model OrderItem {
  id          Int    @id @default(autoincrement())
  orderId     Int
  productName String
  unitAmount  Int     // cents
  quantity    Int
  order       Order   @relation(fields: [orderId], references: [id], onDelete: Cascade)
}

model Category {
  id        Int       @id @default(autoincrement())
  name      String
  parentId  Int?      // null if top-level (like Lighting, Plumbing)
  parent    Category? @relation("Subcategories", fields: [parentId], references: [id])
  children  Category[] @relation("Subcategories")

  products  Product[]
}

model Product {
  id          Int       @id @default(autoincrement())
  name        String
  slug        String    @unique
  price       Int
  description String
  image       String
  inStock     Boolean   @default(true)
  quantity    Int       @default(0)

  categoryId  Int?
  category    Category? @relation(fields: [categoryId], references: [id])

  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}